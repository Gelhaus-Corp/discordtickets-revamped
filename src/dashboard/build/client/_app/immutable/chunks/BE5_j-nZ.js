var de=Object.defineProperty;var F=s=>{throw TypeError(s)};var ue=(s,e,t)=>e in s?de(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var c=(s,e,t)=>ue(s,typeof e!="symbol"?e+"":e,t),he=(s,e,t)=>e.has(s)||F("Cannot "+t);var m=(s,e,t)=>(he(s,e,"read from private field"),t?t.call(s):e.get(s)),C=(s,e,t)=>e.has(s)?F("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t);import"./Bzak7iHL.js";import{m as j,V as me,bG as ve,l as pe,bH as Q,ay as ge,v as _e,X as ke,q as X,P as be,aA as Y,br as ye,bI as xe,bJ as Ce,A as Ee,aj as W,bl as Be,D as $,bK as we,d as G,g as n,s as T,u as ne,U as Oe,au as Ae,p as oe,e as v,h as d,a as u,b as ie,av as Ie,f as Me,i as Te,n as ee}from"./CWXCXDbJ.js";import{s as M}from"./CR2HCHDG.js";import{B as Ne}from"./DU73alKZ.js";import{i as q}from"./BnKh12PZ.js";import{e as De}from"./DuqOsHh6.js";import{c as te}from"./DPC9nAAJ.js";import{s as se}from"./D8EB0mrL.js";const re=0,ae=1,Pe=2;function Se(s,e,t,r,a){j&&me();var l=ve(),p=Be,i=l?W(p):$(p,!1,!1),o=l?W(p):$(p,!1,!1),g=new Ne(s);pe(()=>{var B=e(),w=!1;let L=j&&Q(B)===(s.data===ge);if(L&&(_e(ke()),X(!1)),Q(B)){var z=we(),R=!1;const b=f=>{if(!w){R=!0,z(!1),ye.ensure(),j&&X(!1);try{f()}finally{xe(!1),Ce||Ee()}}};B.then(f=>{b(()=>{Y(i,f),g.ensure(ae,r&&(_=>r(_,i)))})},f=>{b(()=>{if(Y(o,f),g.ensure(Pe,a&&(_=>a(_,o))),!a)throw o.v})}),j?g.ensure(re,t):be(()=>{R||b(()=>{g.ensure(re,t)})})}else Y(i,B),g.ensure(ae,r&&(b=>r(b,i)));return L&&X(!0),()=>{w=!0}})}var N,D;const U=class U extends EventTarget{constructor(t,{id:r,component:a,props:l}){super();c(this,"_props");c(this,"result",He());c(this,"id");c(this,"component");c(this,"modals");C(this,N,G(!1));C(this,D,ne(()=>this.modals.stack.length===0?!1:this.modals.stack[this.modals.stack.length-1].id===this.id&&!this.modals.transitioning));c(this,"close",(...t)=>{var a;if(((a=this.onBeforeClose)==null?void 0:a.call(this))===!1)return!1;const r=t[0];return this.dispatchEvent(new CustomEvent("close",{detail:r})),this.result.resolve(r),!0});c(this,"onBeforeClose");this.id=r||(U._idCounter++).toString(),this.component=a,this._props=l??{},this.modals=t}get exitBeforeEnter(){return n(m(this,N))}set exitBeforeEnter(t){T(m(this,N),t,!0)}get isOpen(){return n(m(this,D))}set isOpen(t){T(m(this,D),t)}get index(){return this.modals.stack.indexOf(this)}get props(){return{...this._props,id:this.id,index:this.index,isOpen:this.isOpen,close:this.close}}get promise(){return this.result.promise}};N=new WeakMap,D=new WeakMap,c(U,"_idCounter",0);let Z=U;function He(){let s,e;return{promise:new Promise((r,a)=>{s=r,e=a}),resolve:s,reject:e}}var P,S,H;class Le{constructor(){C(this,P,G(Oe([])));C(this,S,G(null));C(this,H,G(!1));c(this,"open",async(e,t,r)=>{var p;if(this.transitioning)return;if(r!=null&&r.replace&&!((p=this.stack[this.stack.length-1])==null?void 0:p.close()))throw new Error("Current modal prevented closing");this.action="push";const a=this.stack[this.stack.length-1];a!=null&&a.exitBeforeEnter&&(this.transitioning=!0);const l=new Z(this,{id:r==null?void 0:r.id,component:e,props:t});return this.stack.push(l),l.addEventListener("close",()=>{l.exitBeforeEnter&&(this.transitioning=!0),this.stack.indexOf(l)>-1&&this.stack.splice(this.stack.indexOf(l),1),this.action="pop"},{once:!0}),l.promise});c(this,"close",(e=1)=>{if(typeof e!="number"||e<1)throw new Error(`amount must be a number greater than 0. Received ${e}`);const t=this.stack.slice(this.stack.length-e).reverse();let r=0;for(const a of t){if(!a.close())break;r++}return e===r});c(this,"closeById",e=>{const t=this.stack.find(r=>r.id===e);return t?t.close():!1});c(this,"closeAll",()=>this.close(this.stack.length))}get stack(){return n(m(this,P))}set stack(e){T(m(this,P),e,!0)}get action(){return n(m(this,S))}set action(e){T(m(this,S),e,!0)}get transitioning(){return n(m(this,H))}set transitioning(e){T(m(this,H),e,!0)}}P=new WeakMap,S=new WeakMap,H=new WeakMap;const le=Symbol("modal");function Re(s){Ie(le,s)}function je(){return Ae(le)}function Qe(s){try{const e=je();e.onBeforeClose=s}catch{console.error("onBeforeClose must be called inside a component rendered by Modals");return}}function qe(s,e){oe(e,!0),Re(e.modal);var t=v(),r=d(t);M(r,()=>e.children),u(s,t),ie()}const E=new Le;var Ge=Me("<!> <!>",1);function We(s,e){oe(e,!0);function t(i){return typeof i.prototype>"u"}var r=Ge(),a=d(r);{var l=i=>{var o=v(),g=d(o);M(g,()=>e.backdrop??ee,()=>E),u(i,o)};q(a,i=>{E.stack.length>0&&i(l)})}var p=Te(a,2);De(p,19,()=>E.stack,i=>i.id,(i,o)=>{qe(i,{get modal(){return n(o)},children:(g,B)=>{var w=v(),L=d(w);{var z=f=>{var _=v(),J=d(_);Se(J,()=>n(o).component(),O=>{var y=v(),h=d(y);M(h,()=>e.loading??ee,()=>E),u(O,y)},(O,y)=>{var h=v(),x=d(h);{var A=k=>{var I=v(),V=d(I);M(V,()=>e.modal,()=>({component:n(y).default,props:n(o).props}),()=>E),u(k,I)},K=k=>{var I=v(),V=d(I);te(V,()=>n(y).default,(ce,fe)=>{fe(ce,se(()=>n(o).props))}),u(k,I)};q(x,k=>{e.modal?k(A):k(K,!1)})}u(O,h)}),u(f,_)},R=ne(()=>t(n(o).component)),b=f=>{var _=v(),J=d(_);{var O=h=>{var x=v(),A=d(x);M(A,()=>e.modal,()=>({component:n(o).component,props:n(o).props}),()=>E),u(h,x)},y=h=>{var x=v(),A=d(x);te(A,()=>n(o).component,(K,k)=>{k(K,se(()=>n(o).props))}),u(h,x)};q(J,h=>{e.modal?h(O):h(y,!1)})}u(f,_)};q(L,f=>{n(R)?f(z):f(b,!1)})}u(g,w)},$$slots:{default:!0}})}),u(s,r),ie()}export{We as M,E as m,Qe as o};
