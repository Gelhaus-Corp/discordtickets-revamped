var de=Object.defineProperty;var K=s=>{throw TypeError(s)};var ue=(s,e,t)=>e in s?de(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var c=(s,e,t)=>ue(s,typeof e!="symbol"?e+"":e,t),he=(s,e,t)=>e.has(s)||K("Cannot "+t);var m=(s,e,t)=>(he(s,e,"read from private field"),t?t.call(s):e.get(s)),E=(s,e,t)=>e.has(s)?K("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t);import"./Bzak7iHL.js";import{m as j,V as me,bE as ve,l as pe,bF as Q,as as ge,v as _e,X as ke,q as Y,P as be,au as Z,bp as ye,bG as xe,bH as Ee,A as Ce,an as W,bj as Be,D as $,bI as we,d as G,g as n,s as T,u as ne,U as Oe,aO as Ie,p as oe,e as v,h as d,a as u,b as ie,aP as Ae,f as Me,i as Te,n as ee}from"./w0yj2jlX.js";import{s as M}from"./DBfb9ksp.js";import{B as Ne}from"./D6OMl6Um.js";import{i as q}from"./DP_MZUJz.js";import{e as Pe}from"./CKSmJmMa.js";import{c as te}from"./BsdD4XgB.js";import{s as se}from"./BeFxoXHY.js";const re=0,ae=1,De=2;function Se(s,e,t,r,a){j&&me();var l=ve(),p=Be,i=l?W(p):$(p,!1,!1),o=l?W(p):$(p,!1,!1),g=new Ne(s);pe(()=>{var B=e(),w=!1;let L=j&&Q(B)===(s.data===ge);if(L&&(_e(ke()),Y(!1)),Q(B)){var z=we(),R=!1;const b=f=>{if(!w){R=!0,z(!1),ye.ensure(),j&&Y(!1);try{f()}finally{xe(!1),Ee||Ce()}}};B.then(f=>{b(()=>{Z(i,f),g.ensure(ae,r&&(_=>r(_,i)))})},f=>{b(()=>{if(Z(o,f),g.ensure(De,a&&(_=>a(_,o))),!a)throw o.v})}),j?g.ensure(re,t):be(()=>{R||b(()=>{g.ensure(re,t)})})}else Z(i,B),g.ensure(ae,r&&(b=>r(b,i)));return L&&Y(!0),()=>{w=!0}})}var N,P;const U=class U extends EventTarget{constructor(t,{id:r,component:a,props:l}){super();c(this,"_props");c(this,"result",He());c(this,"id");c(this,"component");c(this,"modals");E(this,N,G(!1));E(this,P,ne(()=>this.modals.stack.length===0?!1:this.modals.stack[this.modals.stack.length-1].id===this.id&&!this.modals.transitioning));c(this,"close",(...t)=>{var a;if(((a=this.onBeforeClose)==null?void 0:a.call(this))===!1)return!1;const r=t[0];return this.dispatchEvent(new CustomEvent("close",{detail:r})),this.result.resolve(r),!0});c(this,"onBeforeClose");this.id=r||(U._idCounter++).toString(),this.component=a,this._props=l??{},this.modals=t}get exitBeforeEnter(){return n(m(this,N))}set exitBeforeEnter(t){T(m(this,N),t,!0)}get isOpen(){return n(m(this,P))}set isOpen(t){T(m(this,P),t)}get index(){return this.modals.stack.indexOf(this)}get props(){return{...this._props,id:this.id,index:this.index,isOpen:this.isOpen,close:this.close}}get promise(){return this.result.promise}};N=new WeakMap,P=new WeakMap,c(U,"_idCounter",0);let J=U;function He(){let s,e;return{promise:new Promise((r,a)=>{s=r,e=a}),resolve:s,reject:e}}var D,S,H;class Le{constructor(){E(this,D,G(Oe([])));E(this,S,G(null));E(this,H,G(!1));c(this,"open",async(e,t,r)=>{var p;if(this.transitioning)return;if(r!=null&&r.replace&&!((p=this.stack[this.stack.length-1])==null?void 0:p.close()))throw new Error("Current modal prevented closing");this.action="push";const a=this.stack[this.stack.length-1];a!=null&&a.exitBeforeEnter&&(this.transitioning=!0);const l=new J(this,{id:r==null?void 0:r.id,component:e,props:t});return this.stack.push(l),l.addEventListener("close",()=>{l.exitBeforeEnter&&(this.transitioning=!0),this.stack.indexOf(l)>-1&&this.stack.splice(this.stack.indexOf(l),1),this.action="pop"},{once:!0}),l.promise});c(this,"close",(e=1)=>{if(typeof e!="number"||e<1)throw new Error(`amount must be a number greater than 0. Received ${e}`);const t=this.stack.slice(this.stack.length-e).reverse();let r=0;for(const a of t){if(!a.close())break;r++}return e===r});c(this,"closeById",e=>{const t=this.stack.find(r=>r.id===e);return t?t.close():!1});c(this,"closeAll",()=>this.close(this.stack.length))}get stack(){return n(m(this,D))}set stack(e){T(m(this,D),e,!0)}get action(){return n(m(this,S))}set action(e){T(m(this,S),e,!0)}get transitioning(){return n(m(this,H))}set transitioning(e){T(m(this,H),e,!0)}}D=new WeakMap,S=new WeakMap,H=new WeakMap;const le=Symbol("modal");function Re(s){Ae(le,s)}function je(){return Ie(le)}function Qe(s){try{const e=je();e.onBeforeClose=s}catch{console.error("onBeforeClose must be called inside a component rendered by Modals");return}}function qe(s,e){oe(e,!0),Re(e.modal);var t=v(),r=d(t);M(r,()=>e.children),u(s,t),ie()}const C=new Le;var Ge=Me("<!> <!>",1);function We(s,e){oe(e,!0);function t(i){return typeof i.prototype>"u"}var r=Ge(),a=d(r);{var l=i=>{var o=v(),g=d(o);M(g,()=>e.backdrop??ee,()=>C),u(i,o)};q(a,i=>{C.stack.length>0&&i(l)})}var p=Te(a,2);Pe(p,19,()=>C.stack,i=>i.id,(i,o)=>{qe(i,{get modal(){return n(o)},children:(g,B)=>{var w=v(),L=d(w);{var z=f=>{var _=v(),F=d(_);Se(F,()=>n(o).component(),O=>{var y=v(),h=d(y);M(h,()=>e.loading??ee,()=>C),u(O,y)},(O,y)=>{var h=v(),x=d(h);{var I=k=>{var A=v(),X=d(A);M(X,()=>e.modal,()=>({component:n(y).default,props:n(o).props}),()=>C),u(k,A)},V=k=>{var A=v(),X=d(A);te(X,()=>n(y).default,(ce,fe)=>{fe(ce,se(()=>n(o).props))}),u(k,A)};q(x,k=>{e.modal?k(I):k(V,!1)})}u(O,h)}),u(f,_)},R=ne(()=>t(n(o).component)),b=f=>{var _=v(),F=d(_);{var O=h=>{var x=v(),I=d(x);M(I,()=>e.modal,()=>({component:n(o).component,props:n(o).props}),()=>C),u(h,x)},y=h=>{var x=v(),I=d(x);te(I,()=>n(o).component,(V,k)=>{k(V,se(()=>n(o).props))}),u(h,x)};q(F,h=>{e.modal?h(O):h(y,!1)})}u(f,_)};q(L,f=>{n(R)?f(z):f(b,!1)})}u(g,w)},$$slots:{default:!0}})}),u(s,r),ie()}export{We as M,C as m,Qe as o};
