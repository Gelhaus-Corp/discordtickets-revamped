import{e as fe}from"../chunks/Cxx9n8vM.js";import"../chunks/Bzak7iHL.js";import{o as me}from"../chunks/BAc9Nw6w.js";import{aU as pe,p as be,U as ge,i as a,h as Z,t as I,aY as he,aV as T,a as f,b as xe,c as s,r as o,aZ as _e,j as K,s as r,f as m,d as _,g as n,u as ye}from"../chunks/CWXCXDbJ.js";import{s as M}from"../chunks/BTVB6o0Y.js";import{i as y}from"../chunks/BnKh12PZ.js";import{r as ke,s as we}from"../chunks/DNgBoiT1.js";import{b as Q}from"../chunks/C43HmXkP.js";import{p as Be}from"../chunks/r2wwZTEc.js";import{s as Ue,a as Ae}from"../chunks/DeGpVRd_.js";import{p as ze}from"../chunks/CgrvsY6N.js";import{b as Se}from"../chunks/L_7WN5SN.js";import{E as je}from"../chunks/CZwjNc88.js";async function Ce({fetch:k,params:u}){var l;const c=await k(`/api/admin/guilds/${u.guild}/customization`),g=(l=c.headers.get("Content-Type"))==null?void 0:l.includes("json"),p=g?await c.json():await c.text();if(!c.ok)fe(c.status,g?JSON.stringify(p):p);else return p||{}}const Ke=Object.freeze(Object.defineProperty({__proto__:null,load:Ce},Symbol.toStringTag,{value:"Module"}));var Ie=m('<div class="mb-4 rounded-lg bg-green-100 p-4 text-green-800 dark:bg-green-500/20 dark:text-green-300"><i class="fa-solid fa-check-circle"></i> </div>'),Te=m('<img alt="Bot Avatar" class="h-32 w-32 rounded-full border-2 border-blurple"/> <button type="button" class="rounded-lg bg-red-300 p-2 px-4 font-medium transition duration-300 hover:bg-red-500 hover:text-white dark:bg-red-500/50 dark:hover:bg-red-500 dark:hover:text-white"><i class="fa-solid fa-trash"></i> Remove Avatar</button>',1),Me=m('<div class="flex h-32 w-32 items-center justify-center rounded-full border-2 border-dashed border-gray-300 bg-gray-50 dark:border-slate-600 dark:bg-slate-800"><i class="fa-solid fa-image text-4xl text-gray-300 dark:text-slate-600"></i></div>'),Ee=m('<i class="fa-solid fa-spinner animate-spin"></i>'),Fe=m('<i class="fa-solid fa-save"></i>'),Ne=m(`<h1 class="m-4 text-center text-4xl font-bold">Bot Customization</h1> <div class="m-2 mx-auto max-w-lg p-4 text-lg"><!> <!> <div class="mb-8 text-center text-blue-600 dark:text-blue-400"><p class="font-semibold"><i class="fa-solid fa-info-circle"></i> Per-Server Settings</p> <p>Customize the bot's appearance for this server. These settings will override the bot's default
			appearance when it interacts in this server.</p></div> <form><div class="my-4 grid grid-cols-1 gap-8"><div><label for="botAvatarInput" class="font-medium">Bot Avatar <i class="fa-solid fa-circle-question cursor-help text-gray-500 dark:text-slate-400" title="Upload a custom avatar for the bot in this server (PNG, JPG, max 1MB)"></i></label> <div class="mt-2 flex flex-col items-center gap-4"><!> <input id="botAvatarInput" type="file" accept="image/*" class="max-w-xs"/></div></div> <div><label for="botUsernameInput" class="font-medium">Bot Username <i class="fa-solid fa-circle-question cursor-help text-gray-500 dark:text-slate-400" title="Custom username for the bot in this server (max 80 characters)"></i></label> <input id="botUsernameInput" type="text" class="input form-input mt-2" placeholder="Leave blank to use default" maxlength="80"/> <p class="mt-1 text-sm text-gray-500 dark:text-slate-400"> </p></div> <div><label for="botBioInput" class="font-medium">Bot Description <i class="fa-solid fa-circle-question cursor-help text-gray-500 dark:text-slate-400" title="Custom description or bio for the bot in this server"></i></label> <textarea id="botBioInput" class="input form-textarea mt-2" placeholder="Leave blank to use default description" rows="4" maxlength="500"></textarea> <p class="mt-1 text-sm text-gray-500 dark:text-slate-400"> </p></div></div> <div class="mt-8 flex gap-4"><button type="submit" class="flex-1 rounded-lg bg-green-300 p-2 px-5 font-medium transition duration-300 hover:bg-green-500 hover:text-white disabled:cursor-not-allowed disabled:opacity-50 dark:bg-green-500/50 dark:hover:bg-green-500 dark:hover:text-white"><!> Save Changes</button> <a href="../general" class="flex items-center justify-center rounded-lg bg-gray-300 p-2 px-5 font-medium transition duration-300 hover:bg-gray-500 hover:text-white dark:bg-slate-600 dark:hover:bg-slate-500"><i class="fa-solid fa-arrow-left"></i> Back</a></div></form></div>`,1);function Qe(k,u){var $,G,V;be(u,!0);const c=()=>Ae(ze,"$page",g),[g,p]=Ue();let l=_(!1),h=_(!1),v=_(null),b=_(""),i=ge({botAvatar:(($=u.data)==null?void 0:$.botAvatar)||"",botBio:((G=u.data)==null?void 0:G.botBio)||"",botUsername:((V=u.data)==null?void 0:V.botUsername)||""});Se(e=>{n(l)&&!confirm("You have unsaved changes; are you sure you want to leave?")&&e.cancel()}),me(()=>{window.addEventListener("beforeunload",e=>{n(l)&&(e.preventDefault(),e.returnValue="")})});const W=(e,t)=>{var Y;const d=(Y=e.target.files)==null?void 0:Y[0];if(!d)return;const j=5*1024*1024;if(d.size>j){r(v,new Error(`File size must be less than 5MB. Selected file is ${(d.size/1024/1024).toFixed(2)}MB`),!0);return}const C=new FileReader;C.onload=ve=>{var H;i[t]=(H=ve.target)==null?void 0:H.result,r(l,!0)},C.onerror=()=>{r(v,new Error("Failed to read file"),!0)},C.readAsDataURL(d)},X=e=>{i[e]="",r(l,!0)},ee=async()=>{try{r(v,null),r(b,""),r(h,!0);const e=await fetch(`/api/admin/guilds/${c().params.guild}/customization`,{method:"PATCH",body:JSON.stringify(i),credentials:"include",headers:{"Content-Type":"application/json; charset=UTF-8"}}),t=await e.json();if(e.ok)r(l,!1),r(b,"Bot customization saved successfully!"),setTimeout(()=>{r(b,"")},3e3);else throw t}catch(e){r(v,e,!0),window.scroll({top:0,behavior:"smooth"})}finally{r(h,!1)}};var E=Ne(),F=a(Z(E),2),N=s(F);{var te=e=>{je(e,{get error(){return n(v)}})};y(N,e=>{n(v)&&e(te)})}var O=a(N,2);{var ae=e=>{var t=Ie(),d=a(s(t));o(t),I(()=>M(d,` ${n(b)??""}`)),f(e,t)};y(O,e=>{n(b)&&e(ae)})}var x=a(O,4),re=ye(()=>Be(()=>ee())),w=s(x),B=s(w),P=a(s(B),2),D=s(P);{var se=e=>{var t=Te(),d=Z(t),j=a(d,2);I(()=>we(d,"src",i.botAvatar)),T("click",j,()=>X("botAvatar")),f(e,t)},oe=e=>{var t=Me();f(e,t)};y(D,e=>{i.botAvatar?e(se):e(oe,!1)})}var ie=a(D,2);o(P),o(B);var U=a(B,2),A=a(s(U),2);ke(A);var J=a(A,2),le=s(J);o(J),o(U);var L=a(U,2),z=a(s(L),2);_e(z);var q=a(z,2),ne=s(q);o(q),o(L),o(w);var R=a(w,2),S=s(R),de=s(S);{var ce=e=>{var t=Ee();f(e,t)},ue=e=>{var t=Fe();f(e,t)};y(de,e=>{n(h)?e(ce):e(ue,!1)})}K(),o(S),K(2),o(R),o(x),o(F),I(()=>{var e,t;M(le,`${(((e=i.botUsername)==null?void 0:e.length)||0)??""}/80`),M(ne,`${(((t=i.botBio)==null?void 0:t.length)||0)??""}/500`),S.disabled=!n(l)||n(h)}),he("submit",x,function(...e){var t;(t=n(re))==null||t.apply(this,e)}),T("change",x,e=>{e.target.type!=="file"&&r(l,!0)}),T("change",ie,e=>W(e,"botAvatar")),Q(A,()=>i.botUsername,e=>i.botUsername=e),Q(z,()=>i.botBio,e=>i.botBio=e),f(k,E),xe(),p()}pe(["change","click"]);export{Qe as component,Ke as universal};
