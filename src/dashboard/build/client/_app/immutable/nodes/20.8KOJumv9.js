import"../chunks/B17Q6ahh.js";import"../chunks/Bzak7iHL.js";import{p as At,i as e,h as Ft,t as y,a as g,b as jt,c as a,r as t,f as x,g as v,aT as Ct,u as G,aU as It}from"../chunks/_fu6EM7d.js";import{s as n}from"../chunks/DbFbsu9R.js";import{i as V}from"../chunks/BkvMZOlF.js";import{e as w,i as p}from"../chunks/CdfWQzPM.js";import{s as Ot}from"../chunks/BZKIRd09.js";import{s as Y}from"../chunks/B_DfNNzh.js";import{s as Tt}from"../chunks/CG3JaKlL.js";import{s as Pt,a as Bt}from"../chunks/CzA9-LZ0.js";import{b as Dt}from"../chunks/DUFA_US_.js";import{p as Nt}from"../chunks/D98LCIk8.js";async function St({fetch:L,params:s}){const M={credentials:"include"};try{const[N,q,H]=await Promise.all([L(`/api/admin/guilds/${s.guild}/feedback`,M),L(`/api/admin/guilds/${s.guild}/analytics`,M),L(`/api/admin/guilds/${s.guild}/categories`,M)]),m=N.ok?await N.json():[],J=q.ok?await q.json():null,K=H.ok?await H.json():[],Q={total:m.length,avgRating:m.length>0?(m.reduce((i,W)=>i+(W.rating||0),0)/m.length).toFixed(2):0,byRating:{5:m.filter(i=>i.rating===5).length,4:m.filter(i=>i.rating===4).length,3:m.filter(i=>i.rating===3).length,2:m.filter(i=>i.rating===2).length,1:m.filter(i=>i.rating===1).length}},R={};return m.forEach(i=>{R[i.categoryId]||(R[i.categoryId]=[]),R[i.categoryId].push(i)}),{feedback:m,stats:Q,feedbackByCategory:R,analytics:J,categories:K}}catch(N){return console.error("Failed to load feedback data:",N),{feedback:[],stats:{total:0,avgRating:0,byRating:{5:0,4:0,3:0,2:0,1:0}},feedbackByCategory:{},analytics:null,categories:[]}}}const na=Object.freeze(Object.defineProperty({__proto__:null,load:St},Symbol.toStringTag,{value:"Module"}));var Et=x("<i></i>"),Lt=x('<i class="fa-solid fa-star text-yellow-500"></i>'),Mt=x('<i class="fa-solid fa-star text-gray-300"></i>'),Ut=x('<div class="flex items-center gap-4"><div class="w-20"><div class="flex items-center gap-1"><!> <!></div> <span class="text-sm font-medium"> </span></div> <div class="flex-1 bg-gray-200 dark:bg-gray-600 rounded-full h-8 overflow-hidden"><div class="bg-yellow-500 h-full flex items-center justify-center text-white text-sm font-medium"><!></div></div> <div class="w-12 text-right font-semibold"> </div></div>'),zt=x("<i></i>"),Gt=x('<div class="text-center"><div class="text-sm font-medium"> </div> <div class="text-lg font-bold text-yellow-600"> </div> <div class="text-xs text-gray-500"> </div></div>'),Vt=x('<div class="rounded-lg border border-gray-200 p-4 dark:border-gray-600"><div class="flex items-center justify-between mb-3"><div class="font-semibold text-lg"> </div> <div class="flex items-center gap-2"><span class="text-sm text-gray-600 dark:text-slate-400"> </span> <div class="flex gap-1"></div> <span class="ml-4 text-sm font-medium text-gray-600 dark:text-slate-400"> </span></div></div> <div class="flex gap-4"></div></div>'),qt=x('<div class="rounded-lg bg-white p-6 shadow-sm dark:bg-slate-700 mb-8"><h2 class="mb-6 text-2xl font-bold">Feedback by Category</h2> <div class="space-y-4"></div></div>'),Ht=x("<i></i>"),Jt=x('<p class="text-sm italic"> </p>'),Kt=x('<div class="mt-2 text-xs text-gray-500"> </div>'),Qt=x('<div><div class="flex items-start justify-between mb-2"><div><div class="font-semibold"> </div> <div class="text-sm text-gray-600 dark:text-slate-400"> </div></div> <div class="flex gap-1"></div></div> <!> <!></div>'),Wt=x('<div class="rounded-lg bg-white p-6 shadow-sm dark:bg-slate-700"><h2 class="mb-6 text-2xl font-bold">Recent Feedback</h2> <div class="space-y-4 max-h-96 overflow-y-auto"></div></div>'),Xt=x('<div class="rounded-lg bg-white p-12 shadow-sm dark:bg-slate-700 text-center"><i class="fa-solid fa-inbox text-6xl text-gray-400 dark:text-gray-600 mb-4"></i> <p class="text-lg text-gray-600 dark:text-slate-400">No feedback yet</p></div>'),Yt=x('<h1 class="m-4 text-center text-4xl font-bold">Feedback & Analytics</h1> <div class="mx-auto my-8 max-w-6xl px-4"><div class="grid grid-cols-1 gap-4 md:grid-cols-4 mb-8"><div class="rounded-lg bg-white p-6 shadow-sm dark:bg-slate-700"><div class="text-sm font-semibold text-gray-600 dark:text-slate-400">Total Feedback</div> <div class="mt-2 text-3xl font-bold"> </div></div> <div class="rounded-lg bg-white p-6 shadow-sm dark:bg-slate-700"><div class="text-sm font-semibold text-gray-600 dark:text-slate-400">Average Rating</div> <div class="mt-2 text-3xl font-bold"> </div> <div class="mt-1 flex gap-1"></div></div> <div class="rounded-lg bg-white p-6 shadow-sm dark:bg-slate-700"><div class="text-sm font-semibold text-gray-600 dark:text-slate-400">Excellent (5★)</div> <div class="mt-2 text-3xl font-bold text-green-600"> </div></div> <div class="rounded-lg bg-white p-6 shadow-sm dark:bg-slate-700"><div class="text-sm font-semibold text-gray-600 dark:text-slate-400">Poor (1★)</div> <div class="mt-2 text-3xl font-bold text-red-600"> </div></div></div> <div class="rounded-lg bg-white p-6 shadow-sm dark:bg-slate-700 mb-8"><h2 class="mb-6 text-2xl font-bold">Rating Distribution</h2> <div class="space-y-4"></div></div> <!> <!> <div class="mt-8 text-center"><a class="inline-block rounded-lg bg-blurple px-6 py-2 text-white transition duration-300 hover:bg-blurple/80">View Full Feedback Portal <i class="fa-solid fa-arrow-right-long ml-2"></i></a></div></div>',1);function ga(L,s){At(s,!0);const M=()=>Bt(Nt,"$page",N),[N,q]=Pt(),H=d=>({5:"Excellent",4:"Good",3:"Okay",2:"Poor",1:"Terrible"})[d]||"Unknown",m=d=>({5:"bg-green-100 dark:bg-green-900/30",4:"bg-blue-100 dark:bg-blue-900/30",3:"bg-yellow-100 dark:bg-yellow-900/30",2:"bg-orange-100 dark:bg-orange-900/30",1:"bg-red-100 dark:bg-red-900/30"})[d]||"bg-gray-100 dark:bg-gray-900/30",J=d=>{var r;return((r=s.data.categories.find(_=>_.id===d))==null?void 0:r.name)||"Unknown"};var K=Yt(),Q=e(Ft(K),2),R=a(Q),i=a(R),W=e(a(i),2),xt=a(W,!0);t(W),t(i);var Z=e(i,2),$=e(a(Z),2),mt=a($);t($);var st=e($,2);w(st,20,()=>Array(5),p,(d,r,_)=>{var u=Et();y(o=>Y(u,1,o),[()=>`fa-solid fa-star text-sm ${_<Math.round(s.data.stats.avgRating)?"text-yellow-500":"text-gray-300"}`]),g(d,u)}),t(st),t(Z);var tt=e(Z,2),it=e(a(tt),2),_t=a(it,!0);t(it),t(tt);var dt=e(tt,2),lt=e(a(dt),2),bt=a(lt,!0);t(lt),t(dt),t(R);var at=e(R,2),vt=e(a(at),2);w(vt,20,()=>[5,4,3,2,1],p,(d,r)=>{var _=Ut(),u=a(_),o=a(u),h=a(o);w(h,17,()=>Array(r),p,(c,j)=>{var l=Lt();g(c,l)});var C=e(h,2);w(C,17,()=>Array(5-r),p,(c,j)=>{var l=Mt();g(c,l)}),t(o);var f=e(o,2),I=a(f,!0);t(f),t(u);var A=e(u,2),k=a(A),O=a(k);{var F=c=>{var j=Ct();y(()=>n(j,s.data.stats.byRating[r])),g(c,j)};V(O,c=>{s.data.stats.byRating[r]/s.data.stats.total*100>20&&c(F)})}t(k),t(A);var T=e(A,2),S=a(T,!0);t(T),t(_),y(c=>{n(I,c),Tt(k,`width: ${s.data.stats.total>0?s.data.stats.byRating[r]/s.data.stats.total*100:0}%`),n(S,s.data.stats.byRating[r])},[()=>H(r)]),g(d,_)}),t(vt),t(at);var ot=e(at,2);{var ft=d=>{var r=qt(),_=e(a(r),2);w(_,21,()=>Object.entries(s.data.feedbackByCategory),p,(u,o)=>{var h=G(()=>It(v(o),2));let C=()=>v(h)[0],f=()=>v(h)[1];const I=G(()=>J(C())),A=G(()=>(f().reduce((D,U)=>D+(U.rating||0),0)/f().length).toFixed(2));var k=Vt(),O=a(k),F=a(O),T=a(F,!0);t(F);var S=e(F,2),c=a(S),j=a(c);t(c);var l=e(c,2);w(l,20,()=>Array(5),p,(D,U,X)=>{var E=zt();y(z=>Y(E,1,z),[()=>`fa-solid fa-star text-sm ${X<Math.round(v(A))?"text-yellow-500":"text-gray-300"}`]),g(D,E)}),t(l);var b=e(l,2),P=a(b);t(b),t(S),t(O);var B=e(O,2);w(B,20,()=>[5,4,3,2,1],p,(D,U)=>{const X=G(()=>f().filter(rt=>rt.rating===U).length);var E=Gt(),z=a(E),wt=a(z);t(z);var et=e(z,2),pt=a(et,!0);t(et);var ct=e(et,2),Rt=a(ct);t(ct),t(E),y(rt=>{n(wt,`${U??""}★`),n(pt,v(X)),n(Rt,`${rt??""}%`)},[()=>(v(X)/f().length*100).toFixed(0)]),g(D,E)}),t(B),t(k),y(()=>{n(T,v(I)),n(j,`${v(A)??""} / 5`),n(P,`${f().length??""} feedback`)}),g(u,k)}),t(_),t(r),g(d,r)},yt=G(()=>Object.keys(s.data.feedbackByCategory).length>0);V(ot,d=>{v(yt)&&d(ft)})}var nt=e(ot,2);{var ut=d=>{var r=Wt(),_=e(a(r),2);w(_,21,()=>s.data.feedback.slice(0,20),p,(u,o)=>{var h=Qt(),C=a(h),f=a(C),I=a(f),A=a(I,!0);t(I);var k=e(I,2),O=a(k);t(k),t(f);var F=e(f,2);w(F,20,()=>Array(5),p,(l,b,P)=>{var B=Ht();y(()=>Y(B,1,`fa-solid fa-star text-sm ${P<v(o).rating?"text-yellow-500":"text-gray-400"}`)),g(l,B)}),t(F),t(C);var T=e(C,2);{var S=l=>{var b=Jt(),P=a(b);t(b),y(()=>n(P,`"${v(o).comment??""}"`)),g(l,b)};V(T,l=>{v(o).comment&&l(S)})}var c=e(T,2);{var j=l=>{var b=Kt(),P=a(b);t(b),y((B,D)=>n(P,`${B??""} at 
								${D??""}`),[()=>new Date(v(o).createdAt).toLocaleDateString(),()=>new Date(v(o).createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]),g(l,b)};V(c,l=>{v(o).createdAt&&l(j)})}t(h),y((l,b)=>{Y(h,1,l),n(A,b),n(O,`Ticket #
									${(v(o).ticketId||"N/A")??""}`)},[()=>`rounded-lg p-4 ${m(v(o).rating)}`,()=>J(v(o).categoryId)]),g(u,h)}),t(_),t(r),g(d,r)},ht=d=>{var r=Xt();g(d,r)};V(nt,d=>{s.data.feedback.length>0?d(ut):d(ht,!1)})}var gt=e(nt,2),kt=a(gt);t(gt),t(Q),y(()=>{n(xt,s.data.stats.total),n(mt,`${s.data.stats.avgRating??""} / 5`),n(_t,s.data.stats.byRating[5]),n(bt,s.data.stats.byRating[1]),Ot(kt,"href",`${Dt}/${M().params.guild}/feedback`)}),g(L,K),jt(),q()}export{ga as component,na as universal};
